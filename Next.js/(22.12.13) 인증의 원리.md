# 인증의 원리

---

## 인증의 두 가지 방식

### 1. Server-side Sessions

- 작동 방식

  - 고유한 식별자(Session ID)를 서버에 저장하고, 같은 식별자를 클라이언트에 전송

  - 클라이언트는 식별자를 저장해두고, 서버에 요청을 보낼 때 그 식별자를 첨부

- 보안

  - 서버는 클라이언트에서 온 식별자와 서버에 저장된 식별자가 같은지 확인

  - 연결을 암호화하는데 SSL을 사용하여 도난당할 위험 없음

  - 쿠키에 식별자 저장하기 때문에 쿠키에 JavaScript를 통해서 접근할 수 없게 구성할 수 있음

### 2. Authentication Tokens

- 서버가 어떤 식별자를 저장하는 대신 토큰을 발급하고 서명함

- 클라이언트는 토큰을 저장해두고,서버에 요청을 보낼 때 그 토큰을 첨부

- 서버는 토큰을 저장해두지 않더라도, 해당 토큰에 어떻게 서명했는지 기억함 → 서버는 자기가 만든 토큰 확인 가능

### 3. Next.js와 React에서 인증을 위해 주로 Token을 사용하는 이유

- SPA에서 페이지는 직접 제공되고 반드시 서버에 도달하지 않아도 논리로 채워짐

- 프론트엔드 JavaScript를 통해 동적으로 페이지 생성됨 (SPA)

- 방문하는 모든 페이지마다 서버에 요청을 보내는 것이 아님 → 서버가 인증 확인할 수 없는 상태에서 페이지 로드됨

- 따라서 클라이언트 스스로 본인이 인증되었다는 독립적 권한이 필요함

---

## JSON Web Token 이해

- 발급자, 커스텀 데이터, 비밀 키를 결합하여 이 모든 데이트를 포함하는 임의의 문자열 만들고, 해당 키로 서명하여 토큰 생성

- 서명은 암호화를 뜻하는 게 아님 (JWT는 암호화 되지 않고, 키 없이 열어서 내부 데이터 볼 수 있음)

- 키는 주어진 서버가 그 토큰을 서명했다는 것만 증명

### 1. 발급자 (Issuer Data)

- 토근이 생성될 때 서버에 의해 토큰에 자동으로 추가되는 데이터

- 토큰 생성할 때 사용한 서드 파티 패키지에 의해 생성된 메타데이터

### 2. 커스텀 데이터 (Customer Data)

- 유저 데이터 등

### 3. 비밀 키 (Secret Signing Key)

- 비밀키를 서버에서 설정하여 클라언트는 절대 볼 수 없음

- 해당 키가 있어야 서버가 인정하는 유효 토큰 생성 가능 (key는 서버만 알고 있음)
